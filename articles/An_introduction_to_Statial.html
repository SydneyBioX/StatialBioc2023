<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>An Introduction to Statial • StatialBioc2023</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="An Introduction to Statial">
<meta property="og:description" content="StatialBioc2023">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">StatialBioc2023</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/An_introduction_to_Statial.html">An Introduction to Statial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SydneyBioX/StatialBioc2023" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>An Introduction to Statial</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/SydneyBioX/StatialBioc2023/blob/HEAD/vignettes/An_introduction_to_Statial.Rmd" class="external-link"><code>vignettes/An_introduction_to_Statial.Rmd</code></a></small>
      <div class="hidden name"><code>An_introduction_to_Statial.Rmd</code></div>

    </div>

    
    
<p><img src="images/Statial.png" align="right" style="height: 200px; border: 0px"></p>
<p>Farhan Ameen, Alex Qin, Nick Robertson, Sourish Iyengar, Shila
Ghazanfar, Ellis Patrick<span class="math inline">\(^{1,2,3}\)</span>.</p>
<p><span class="math inline">\(^1\)</span> Westmead Institute for
Medical Research, University of Sydney, Australia<br><span class="math inline">\(^2\)</span> Sydney Precision Data Science
Centre, University of Sydney, Australia<br><span class="math inline">\(^3\)</span> School of Mathematics and
Statistics, University of Sydney, Australia</p>
<p><br> contact: ellis.patrick@sydney.edu.au</p>
<div class="section level3">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h3>
<p>There are over 37 trillion cells in the human body, each taking up
different forms and functions. The behaviour of these cells can be
described by canonical characteristics, but their functions can also
dynamically change based on their environmental context, leading to
cells with diverse states. Understanding changes in cell state related
to their spatial context in the tissue microenvironment is key to
understanding how spatial interactions between cells can contributes to
human disease. State-of-the-art technologies such as PhenoCycler, IMC,
CosMx, Xenium, MERFISH and many others have made it possible to deeply
phenotype characteristics of cells in their native environment. This has
created the exciting opportunity to identify spatially related changes
in cell state in a high-thoughput manner.</p>
</div>
<div class="section level3">
<h3 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h3>
<p>Statial is a Bioconductor package which contains a suite of
complementary approaches for identifying changes in cell state and how
these changes are associated with cell type localisation. This workshop
will introduce new functionality in the Statial package which can</p>
<ol style="list-style-type: decimal">
<li>uncover changes in marker expression associated with cell
proximities and</li>
<li>model spatial relationships between cells in the context of
hierarchical cell lineage structures.</li>
<li>identify changes in cell state between distinct tissue
environments,</li>
</ol>
<div class="section level4">
<h4 id="pre-requisites">Pre-requisites<a class="anchor" aria-label="anchor" href="#pre-requisites"></a>
</h4>
<p>It is expected that students will have:</p>
<ul>
<li>basic knowledge of R syntax,</li>
<li>familiarity with SingleCellExperiment and/or SpatialExperiment
objects, and</li>
<li>this workshop will not provide an in-depth description of
cell-resolution spatial omics technologies.</li>
</ul>
</div>
<div class="section level4">
<h4 id="participation">Participation<a class="anchor" aria-label="anchor" href="#participation"></a>
</h4>
<p>While it will be possible for participantsto run code as we go
through the demonstration, given time constraints, I would encourage
them to focus their attention into critiquing when and why modelling the
spatial relationships between cells in these ways is appropriate.
Questions are welcome both within the workshop and if students choose to
workthrough the workshop independently after the demonstration.</p>
</div>
<div class="section level4">
<h4 id="r-bioconductor-packages-used">
<em>R</em> / <em>Bioconductor</em> packages used<a class="anchor" aria-label="anchor" href="#r-bioconductor-packages-used"></a>
</h4>
<p>While this workshop will focus on the functionality of Statial, it
will tangentially touch on other Bioconductor packages we have developed
for these technologies such as <a href="https://www.bioconductor.org/packages/release/bioc/html/spicyR.html" class="external-link">spicyR</a>,
<a href="https://www.bioconductor.org/packages/release/bioc/html/lisaClust.html" class="external-link">lisaClust</a>
and <a href="https://www.bioconductor.org/packages/release/bioc/html/ClassifyR.html" class="external-link">ClassifyR</a>.</p>
<p><img src="images/spicyR.png" alt="spicyR" style="height: 200px; border: 0px"><img src="images/lisaClust.png" alt="lisaClust" style="height: 200px; width: 173px; border: 0px"><img src="images/ClassifyR.png" alt="ClassifyR" style="height: 200px; border: 0px"></p>
</div>
<div class="section level4">
<h4 id="time-outline">Time outline<a class="anchor" aria-label="anchor" href="#time-outline"></a>
</h4>
<p>An example for a 45-minute workshop:</p>
<table class="table">
<thead><tr class="header">
<th>Activity</th>
<th>Time</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Packages</td>
<td>15m</td>
</tr>
<tr class="even">
<td>Package Development</td>
<td>15m</td>
</tr>
<tr class="odd">
<td>Contributing to Bioconductor</td>
<td>5m</td>
</tr>
<tr class="even">
<td>Best Practices</td>
<td>10m</td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="workshop-goals-and-objectives">Workshop goals and objectives<a class="anchor" aria-label="anchor" href="#workshop-goals-and-objectives"></a>
</h4>
<div class="section level5">
<h5 id="learning-goals">Learning goals<a class="anchor" aria-label="anchor" href="#learning-goals"></a>
</h5>
<ul>
<li>identify methods which align with spatial hypothese of
interest.</li>
<li>understand the difference between the approaches and when they will
be appropriate.</li>
<li>appreciate the limitations of the differences approaches and when
they will be uninformative.</li>
</ul>
</div>
<div class="section level5">
<h5 id="learning-objectives">Learning objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h5>
<ul>
<li>apply functions to identify various types of changes in cell
state.</li>
<li>interpret output from tests and quantifications.</li>
<li>evaluate the appropriateness of different analytical
approaches.</li>
<li>assess the performance of classification approaches that utilise
cell state features.</li>
</ul>
</div>
</div>
</div>
<div class="section level3">
<h3 id="workshop">Workshop<a class="anchor" aria-label="anchor" href="#workshop"></a>
</h3>
<div class="section level4">
<h4 id="load-packages">Load packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">Statial</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">spicyR</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lisaClust</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sydneybiox.github.io/ClassifyR/" class="external-link">ClassifyR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/drighelli/SpatialExperiment" class="external-link">SpatialExperiment</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span></code></pre></div>
<p>The definitions of cell types and cell states are somewhat ambiguous.
We will purposefully skirt the debate of what is a cell type vs cell
state. Instead, in this workshop I would ask participants to associate
<em>cell state</em> terminology to simply mean a varying phenotype
(<em>state</em>) of a large cluster of similar cells (<em>cell
type</em>). In this workshop we will examine two analytically distinct
changes in cell state:</p>
<ol style="list-style-type: decimal">
<li>
<em>A continuous change in state.</em> The state of a cell type is
defined by variation in abundance of a gene or protein.<br>
</li>
<li>
<em>A discrete change in state.</em> Cell types (clusters of cells)
are further clustered into sub-clusters. These finer-resolution
phenotypes of the cell type are labelled as cell states.</li>
</ol>
</div>
<div class="section level4">
<h4 id="identifying-continuous-changes-in-cell-state">Identifying continuous changes in cell state<a class="anchor" aria-label="anchor" href="#identifying-continuous-changes-in-cell-state"></a>
</h4>
<p>Changes in cell states can be analytically framed as the change in
abundance of a gene or protein within a particular cell type. We can
look to see if a cell type changes state when in close proximity to
another cell type. In the figures below we see the abundance of a
particular marker increased in circle cells that are closer to square
cells.</p>
<p><img src="images/cts1.png" alt="cts1" style="width: 50%; border: 0px"><img src="images/cts2.png" alt="cts2" style="width: 35%; border: 0px"></p>
<p>We can use Statial to quantify and test for these types of
relationships.</p>
<div class="section level5">
<h5 id="a-change-in-state-within-a-single-image-">A change in state within a single image.<a class="anchor" aria-label="anchor" href="#a-change-in-state-within-a-single-image-"></a>
</h5>
<div class="section level7">
<h6 id="code-to-run-for-everything-e-g--dont-specify-for-relationships">Code to run for everything (e.g. don’t specify for
relationships)<a class="anchor" aria-label="anchor" href="#code-to-run-for-everything-e-g--dont-specify-for-relationships"></a>
</h6>
</div>
<div class="section level7">
<h6 id="which-interactions-dont-make-sense">Which interactions don’t make sense<a class="anchor" aria-label="anchor" href="#which-interactions-dont-make-sense"></a>
</h6>
</div>
<div class="section level7">
<h6 id="marker-contamination-from-lateral-spillover">Marker contamination from lateral spillover<a class="anchor" aria-label="anchor" href="#marker-contamination-from-lateral-spillover"></a>
</h6>
</div>
<div class="section level6">
<h6 id="correcting-for-lateral-spillover-with-cell-type-deconvolution-">Correcting for lateral spillover with cell type deconvolution.<a class="anchor" aria-label="anchor" href="#correcting-for-lateral-spillover-with-cell-type-deconvolution-"></a>
</h6>
<p>Show that it helps. ##### ROC curve showing contamination calculation
works (somewhat)</p>
</div>
</div>
<div class="section level5">
<h5 id="identify-change-in-state-consistent-across-images-">Identify change in state consistent across images.<a class="anchor" aria-label="anchor" href="#identify-change-in-state-consistent-across-images-"></a>
</h5>
<div class="section level6">
<h6 id="mixed-model">Mixed model<a class="anchor" aria-label="anchor" href="#mixed-model"></a>
</h6>
</div>
</div>
<div class="section level5">
<h5 id="associate-these-changes-with-a-patient-outcome">Associate these changes with a patient outcome<a class="anchor" aria-label="anchor" href="#associate-these-changes-with-a-patient-outcome"></a>
</h5>
<div class="section level6">
<h6 id="proportionalhazards-models">ProportionalHazards Models<a class="anchor" aria-label="anchor" href="#proportionalhazards-models"></a>
</h6>
</div>
<div class="section level6">
<h6 id="generate-imagemodels-and-see-if-the-image-features-are-associated-with-survival-with-spicyrcoltest">Generate imageModels and see if the image features are associated
with survival with spicyR::colTest<a class="anchor" aria-label="anchor" href="#generate-imagemodels-and-see-if-the-image-features-are-associated-with-survival-with-spicyrcoltest"></a>
</h6>
</div>
</div>
</div>
<div class="section level4">
<h4 id="identifying-continuous-changes-in-cell-state-within-spatial-domains">Identifying continuous changes in cell state within spatial
domains<a class="anchor" aria-label="anchor" href="#identifying-continuous-changes-in-cell-state-within-spatial-domains"></a>
</h4>
<p>We can look at changes of cell state relative to membership of
different spatial domains. These domains can represent distinct tissue
microenvironments where cells will potentially be interacting with
different types cells.</p>
<p><img src="images/region.png" alt="cts1" style="width: 70%; border: 0px"></p>
<p>Here we see the abundance of a marker being higher in cell type 2
within spatial region 1 than spatial region 2.</p>
<p>####LISACLUST</p>
</div>
<div class="section level4">
<h4 id="identify-spatial-domains-with-lisaclust">Identify spatial domains with lisaClust<a class="anchor" aria-label="anchor" href="#identify-spatial-domains-with-lisaclust"></a>
</h4>
</div>
</div>
<div class="section level3">
<h3 id="test-between-spatial-domains">Test between spatial domains<a class="anchor" aria-label="anchor" href="#test-between-spatial-domains"></a>
</h3>
</div>
<div class="section level3">
<h3 id="associate-with-a-patient-outcome">Associate with a patient outcome<a class="anchor" aria-label="anchor" href="#associate-with-a-patient-outcome"></a>
</h3>
<div class="section level4">
<h4 id="identifying-discrete-changes-in-cell-state-with-kontextual">Identifying discrete changes in cell state with Kontextual<a class="anchor" aria-label="anchor" href="#identifying-discrete-changes-in-cell-state-with-kontextual"></a>
</h4>
<p>Reiterate the approach</p>
<p><img src="images/KontextSpace.png" alt="Kontext" style="width 40%; border: 0px"></p>
<p>We introduce Kontextual</p>
<p><img src="images/Kontextual.png" alt="Kontextual" style="width: 65%`; border: 0px"></p>
<p>For the purposes of using <code>Kontextual</code> we treat cell
states as identified clusters of cells, where larger clusters represent
a “parent” cell population, and finer sub-clusters representing a
“child” cell population. For example a CD4 T cell may be considered a
child to a larger parent population of Immune cells.
<code>Kontextual</code> thus aims to see how a child population of cells
deviate from the spatial behaviour of their parent population, and how
that influences the localisation between the child cell state and
another cell state.</p>
<div class="section level5">
<h5 id="identify-within-a-single-image">Identify within a single image<a class="anchor" aria-label="anchor" href="#identify-within-a-single-image"></a>
</h5>
</div>
</div>
</div>
<div class="section level3">
<h3 id="identify-across-images">Identify across images<a class="anchor" aria-label="anchor" href="#identify-across-images"></a>
</h3>
</div>
<div class="section level3">
<h3 id="associate-with-a-patient-outcome-1">Associate with a patient outcome<a class="anchor" aria-label="anchor" href="#associate-with-a-patient-outcome-1"></a>
</h3>
<p>We might need to add coxph tests to the colTest function. Nick could
potentially help with this. If not, for-loop it.</p>
</div>
<div class="section level2">
<h2 id="predicting-patient-outcomes">Predicting patient outcomes<a class="anchor" aria-label="anchor" href="#predicting-patient-outcomes"></a>
</h2>
<div class="section level3">
<h3 id="extract-feature-sets">Extract feature sets<a class="anchor" aria-label="anchor" href="#extract-feature-sets"></a>
</h3>
</div>
<div class="section level3">
<h3 id="run-classifyr">Run classifyR<a class="anchor" aria-label="anchor" href="#run-classifyr"></a>
</h3>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Farhan Ameen, Alex Qin, Nick Robertson, Sourish Iyengar, Shila Ghazanfar, Ellis Patrick.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
